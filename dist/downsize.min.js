/*! downsize 22-07-2014 */
"use strict";function Downsize(a){if(!a)throw console.log(a),new Error("missing options");if(!a.src)throw console.log(a),new Error("missing source paramter");return this instanceof Downsize?(this.canvas=a.canvas||document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.src=a.src,this.steps=a.steps||4,this.size=a.size||.5,this.stepSize=Math.pow(this.size,1/this.steps),this.createImage(this.src),this.canvas):(console.log(1,a),new Downsize(a))}Downsize.prototype.createImage=function(a){var b=new Image;b.onload=function(){var a=document.createElement("canvas"),c=a.getContext("2d");a.width=b.width,a.height=b.height,c.drawImage(b,0,0,b.width,b.height),this.steps--,this.downSample(a)}.bind(this),b.src=a,this.image=b},Downsize.prototype.downSample=function(a){for(var b=this.steps,c=this.stepSize,d=a.getContext("2d");b>0;)b--,d.drawImage(a,0,0,a.width*c,a.height*c);this.saveCanvas(a)},Downsize.prototype.saveCanvas=function(a){var b=this.canvas,c=this.ctx,d=this.image,e=this.size;b.width=d.width*e,b.height=d.height*e,c.drawImage(a,0,0,d.width*e,d.height*e,0,0,b.width,b.height)},Downsize.VERSION="0.1.0","undefined"!=typeof module&&module.exports&&(module.exports=Downsize);